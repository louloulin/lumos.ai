# Mastra åˆ° Rust çš„è¿ç§»è®¡åˆ’

## 1. é¡¹ç›®æ¦‚è¿°

Mastraæ˜¯ä¸€ä¸ªç”¨TypeScriptç¼–å†™çš„AIåº”ç”¨æ¡†æ¶ï¼Œæä¾›ä»¥ä¸‹æ ¸å¿ƒåŠŸèƒ½ï¼š

- **Agentç³»ç»Ÿ**ï¼šå…è®¸è¯­è¨€æ¨¡å‹é€‰æ‹©æ‰§è¡Œä¸€ç³»åˆ—åŠ¨ä½œçš„ç³»ç»Ÿ âœ…
- **å·¥ä½œæµå¼•æ“**ï¼šå¯æŒä¹…åŒ–çš„åŸºäºå›¾çš„çŠ¶æ€æœº âœ…
- **RAG (æ£€ç´¢å¢å¼ºç”Ÿæˆ)**ï¼šæ„å»ºçŸ¥è¯†åº“çš„ETLç®¡é“ âœ…
- **é›†æˆç³»ç»Ÿ**ï¼šè‡ªåŠ¨ç”Ÿæˆçš„ç±»å‹å®‰å…¨çš„ç¬¬ä¸‰æ–¹æœåŠ¡APIå®¢æˆ·ç«¯
- **è¯„ä¼°æ¡†æ¶**ï¼šä½¿ç”¨æ¨¡å‹è¯„åˆ†ã€åŸºäºè§„åˆ™å’Œç»Ÿè®¡æ–¹æ³•è¯„ä¼°LLMè¾“å‡ºçš„å·¥å…· âœ…
- **å·¥å…·ç³»ç»Ÿ**ï¼šå¯ç”±Agentæˆ–å·¥ä½œæµæ‰§è¡Œçš„ç±»å‹åŒ–å‡½æ•° âœ…
- **è®°å¿†ç³»ç»Ÿ**ï¼šå¸®åŠ©å­˜å‚¨å’Œæ£€ç´¢ä¸Šä¸‹æ–‡ä¿¡æ¯çš„ç»„ä»¶ âœ…

## 2. æŠ€æœ¯æ ˆå¯¹æ¯”

| åŠŸèƒ½ | Mastra (TypeScript) | Lomusai (Rust) |
|------|-------------------|----------------|
| è¯­è¨€ | TypeScript/JavaScript | Rust âœ… |
| åŒ…ç®¡ç† | pnpm | Cargo âœ… |
| ä¾èµ–è§£æ | node_modules | Cargo.toml âœ… |
| æ„å»ºå·¥å…· | Turbo, tsup | Cargo/rustc âœ… |
| ç±»å‹ç³»ç»Ÿ | TypeScripté™æ€ç±»å‹ | Rusté™æ€ç±»å‹+æ‰€æœ‰æƒç³»ç»Ÿ âœ… |
| å¼‚æ­¥æ¨¡å‹ | Promise/async-await | Futures/async-await âœ… |
| å†…å­˜ç®¡ç† | åƒåœ¾å›æ”¶ | RAII, æ‰€æœ‰æƒç³»ç»Ÿ âœ… |
| é”™è¯¯å¤„ç† | try/catch, Result | Result<T, E> âœ… |

## 3. è¿ç§»ç­–ç•¥

### 3.1 é˜¶æ®µåˆ’åˆ†

1. **é˜¶æ®µä¸€ï¼šæ ¸å¿ƒåº“è¿ç§»** âœ…
   - è®¾è®¡Rustæ ¸å¿ƒåº“æ¶æ„ âœ…
   - å®ç°åŸºç¡€ç±»å‹å’Œæ¥å£ âœ…
   - è¿ç§»æ ¸å¿ƒåŠŸèƒ½ï¼šAgents, Workflows, Tools âœ…

2. **é˜¶æ®µäºŒï¼šåŠŸèƒ½æ¨¡å—è¿ç§»** âœ…
   - å®ç°RAGæ¨¡å— âœ…
   - å®ç°Memoryæ¨¡å— âœ…
   - å®ç°Evalsæ¨¡å— âœ…

3. **é˜¶æ®µä¸‰ï¼šé›†æˆå’Œéƒ¨ç½²**
   - å®ç°ç¬¬ä¸‰æ–¹æœåŠ¡é›†æˆ
   - å¼€å‘éƒ¨ç½²å™¨
   - è¿ç§»CLIå·¥å…·

4. **é˜¶æ®µå››ï¼šæ€§èƒ½ä¼˜åŒ–å’Œæµ‹è¯•**
   - æ€§èƒ½åŸºå‡†æµ‹è¯•
   - å†…å­˜ä¼˜åŒ–
   - å¤šçº¿ç¨‹/å¹¶è¡Œä¼˜åŒ–

### 3.2 æ¨¡å—æ˜ å°„å…³ç³»

| Mastraæ¨¡å— | Lomusaiæ¨¡å— | çŠ¶æ€ |
|-----------|-----------|------|
| @mastra/core | lomusai_core | âœ… å·²å®ç°åŸºç¡€åŠŸèƒ½ |
| @mastra/rag | lomusai_rag | âœ… å·²å®ç°åŸºç¡€åŠŸèƒ½ |
| @mastra/memory | lomusai_memory | âœ… å·²å®ç°åŸºç¡€åŠŸèƒ½ |
| @mastra/evals | lomusai_evals | âœ… å·²å®ç°åŸºç¡€åŠŸèƒ½ |
| @mastra/cli | lomusai_cli | ğŸ”„ å¾…å®ç° |
| @mastra/deployer | lomusai_deployer | ğŸ”„ å¾…å®ç° |
| integrations/* | lomusai_integrations | ğŸ”„ å¾…å®ç° |

## 4. è¯¦ç»†å®ç°è®¡åˆ’

### 4.1 ä¼˜åŒ–çš„æ¨¡å—åŒ–æ¶æ„è®¾è®¡ âœ…

```
lomusai/
â”œâ”€â”€ crates/                      // æ‰€æœ‰crateé›†ä¸­ç®¡ç†
â”‚   â”œâ”€â”€ lomusai/                 // ä¸»åŒ…/å…¥å£
â”‚   â”‚   â””â”€â”€ src/
â”‚   â”‚       â”œâ”€â”€ lib.rs           // é‡å¯¼å‡ºæ‰€æœ‰æ¨¡å—
â”‚   â”‚       â””â”€â”€ bin/             // CLIå…¥å£
â”‚   â”‚
â”‚   â”œâ”€â”€ lomusai_core/            // æ ¸å¿ƒåŠŸèƒ½ âœ…
â”‚   â”‚   â””â”€â”€ src/
â”‚   â”‚       â”œâ”€â”€ lib.rs           // å…¬å…±APIå¯¼å‡º
â”‚   â”‚       â”œâ”€â”€ error.rs         // é”™è¯¯å¤„ç† âœ… 
â”‚   â”‚       â”œâ”€â”€ types/           // é€šç”¨æ ¸å¿ƒç±»å‹
â”‚   â”‚       â”‚   â””â”€â”€ mod.rs
â”‚   â”‚       â”œâ”€â”€ agent/           // Agentå®ç° âœ…
â”‚   â”‚       â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚       â”‚   â”œâ”€â”€ config.rs    // Agenté…ç½®
â”‚   â”‚       â”‚   â””â”€â”€ executor.rs  // Agentæ‰§è¡Œå™¨
â”‚   â”‚       â”œâ”€â”€ workflow/        // å·¥ä½œæµå®ç° âœ… 
â”‚   â”‚       â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚       â”‚   â”œâ”€â”€ step.rs      // å·¥ä½œæµæ­¥éª¤
â”‚   â”‚       â”‚   â”œâ”€â”€ state.rs     // å·¥ä½œæµçŠ¶æ€
â”‚   â”‚       â”‚   â””â”€â”€ executor.rs  // å·¥ä½œæµæ‰§è¡Œå™¨
â”‚   â”‚       â”œâ”€â”€ tool/            // å·¥å…·ç³»ç»Ÿ âœ…
â”‚   â”‚       â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚       â”‚   â”œâ”€â”€ schema.rs    // å·¥å…·æ¨¡å¼å®šä¹‰
â”‚   â”‚       â”‚   â””â”€â”€ function.rs  // å‡½æ•°å·¥å…·
â”‚   â”‚       â”œâ”€â”€ llm/             // LLMæ¥å£ âœ…
â”‚   â”‚       â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚       â”‚   â”œâ”€â”€ provider.rs  // LLMæä¾›è€…ç‰¹æ€§
â”‚   â”‚       â”‚   â”œâ”€â”€ openai.rs    // OpenAIå®ç°
â”‚   â”‚       â”‚   â””â”€â”€ anthropic.rs // Anthropicå®ç°
â”‚   â”‚       â””â”€â”€ telemetry/       // é¥æµ‹å’Œè·Ÿè¸ª âœ…
â”‚   â”‚           â”œâ”€â”€ mod.rs
â”‚   â”‚           â”œâ”€â”€ event.rs     // äº‹ä»¶å®šä¹‰
â”‚   â”‚           â”œâ”€â”€ sink.rs      // é¥æµ‹æ¥æ”¶å™¨ç‰¹æ€§
â”‚   â”‚           â””â”€â”€ span.rs      // è·Ÿè¸ªåŒºé—´
â”‚   â”‚
â”‚   â”œâ”€â”€ lomusai_memory/          // è®°å¿†ç³»ç»Ÿ âœ…
â”‚   â”‚   â””â”€â”€ src/
â”‚   â”‚       â”œâ”€â”€ lib.rs           // å…¬å…±APIå¯¼å‡º
â”‚   â”‚       â”œâ”€â”€ types.rs         // è®°å¿†ç±»å‹å®šä¹‰
â”‚   â”‚       â”œâ”€â”€ storage/         // å­˜å‚¨å®ç°
â”‚   â”‚       â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚       â”‚   â”œâ”€â”€ in_memory.rs // å†…å­˜å­˜å‚¨
â”‚   â”‚       â”‚   â””â”€â”€ persistent.rs // æŒä¹…åŒ–å­˜å‚¨
â”‚   â”‚       â””â”€â”€ retrieval/       // æ£€ç´¢ç­–ç•¥
â”‚   â”‚           â”œâ”€â”€ mod.rs
â”‚   â”‚           â”œâ”€â”€ recent.rs    // æœ€è¿‘è®°å¿†
â”‚   â”‚           â””â”€â”€ semantic.rs  // è¯­ä¹‰æœç´¢
â”‚   â”‚
â”‚   â”œâ”€â”€ lomusai_rag/             // RAGåŠŸèƒ½ âœ…
â”‚   â”‚   â””â”€â”€ src/
â”‚   â”‚       â”œâ”€â”€ lib.rs           // å…¬å…±APIå¯¼å‡º
â”‚   â”‚       â”œâ”€â”€ error.rs         // é”™è¯¯å¤„ç†
â”‚   â”‚       â”œâ”€â”€ types.rs         // RAGç±»å‹å®šä¹‰
â”‚   â”‚       â”œâ”€â”€ document/        // æ–‡æ¡£å¤„ç†
â”‚   â”‚       â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚       â”‚   â”œâ”€â”€ loader.rs    // æ–‡æ¡£åŠ è½½å™¨
â”‚   â”‚       â”‚   â”œâ”€â”€ parser.rs    // æ–‡æ¡£è§£æå™¨
â”‚   â”‚       â”‚   â””â”€â”€ chunker.rs   // æ–‡æ¡£åˆ†å—
â”‚   â”‚       â”œâ”€â”€ embedding/       // å‘é‡åµŒå…¥
â”‚   â”‚       â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚       â”‚   â”œâ”€â”€ provider.rs  // åµŒå…¥æä¾›è€…ç‰¹æ€§
â”‚   â”‚       â”‚   â””â”€â”€ openai.rs    // OpenAIåµŒå…¥å®ç°
â”‚   â”‚       â””â”€â”€ retriever/       // æ£€ç´¢å™¨
â”‚   â”‚           â”œâ”€â”€ mod.rs
â”‚   â”‚           â”œâ”€â”€ vector_store.rs // å‘é‡å­˜å‚¨æ¥å£
â”‚   â”‚           â””â”€â”€ in_memory.rs // å†…å­˜å‘é‡å­˜å‚¨
â”‚   â”‚
â”‚   â”œâ”€â”€ lomusai_evals/           // è¯„ä¼°æ¡†æ¶ âœ…
â”‚   â”‚   â””â”€â”€ src/
â”‚   â”‚       â”œâ”€â”€ lib.rs
â”‚   â”‚       â”œâ”€â”€ metrics/         // è¯„ä¼°æŒ‡æ ‡
â”‚   â”‚       â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚       â”‚   â”œâ”€â”€ accuracy.rs  // å‡†ç¡®æ€§æŒ‡æ ‡
â”‚   â”‚       â”‚   â”œâ”€â”€ relevance.rs // ç›¸å…³æ€§æŒ‡æ ‡
â”‚   â”‚       â”‚   â”œâ”€â”€ coherence.rs // è¿è´¯æ€§æŒ‡æ ‡
â”‚   â”‚       â”‚   â””â”€â”€ llm_eval.rs  // LLMè¯„ä¼°æŒ‡æ ‡
â”‚   â”‚       â””â”€â”€ evaluator/       // è¯„ä¼°å™¨
â”‚   â”‚           â”œâ”€â”€ mod.rs
â”‚   â”‚           â”œâ”€â”€ llm_eval.rs  // LLMè¯„ä¼°
â”‚   â”‚           â””â”€â”€ rule_eval.rs // è§„åˆ™è¯„ä¼°
â”‚   â”‚
â”‚   â”œâ”€â”€ lomusai_integrations/    // é›†æˆåº“ ğŸ”„
â”‚   â”‚   â””â”€â”€ src/
â”‚   â”‚       â”œâ”€â”€ lib.rs
â”‚   â”‚       â””â”€â”€ providers/       // ç¬¬ä¸‰æ–¹æœåŠ¡
â”‚   â”‚           â”œâ”€â”€ mod.rs
â”‚   â”‚           â””â”€â”€ ...
â”‚   â”‚
â”‚   â””â”€â”€ lomusai_deployer/        // éƒ¨ç½²å·¥å…· ğŸ”„
â”‚       â””â”€â”€ src/
â”‚           â”œâ”€â”€ lib.rs
â”‚           â”œâ”€â”€ platforms/       // éƒ¨ç½²å¹³å°
â”‚           â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚           â””â”€â”€ ...
â”‚   â”‚
â”‚   â””â”€â”€ packaging/       // æ‰“åŒ…å·¥å…·
â”‚       â”œâ”€â”€ mod.rs
â”‚       â””â”€â”€ ...
â”‚
â”œâ”€â”€ examples/                    // ç¤ºä¾‹åº”ç”¨
â”‚   â”œâ”€â”€ simple_agent/            // ç®€å•Agentç¤ºä¾‹
â”‚   â”‚   â”œâ”€â”€ Cargo.toml
â”‚   â”‚   â””â”€â”€ src/main.rs
â”‚   â”œâ”€â”€ workflow_demo/           // å·¥ä½œæµç¤ºä¾‹
â”‚   â”‚   â”œâ”€â”€ Cargo.toml
â”‚   â”‚   â””â”€â”€ src/main.rs
â”‚   â””â”€â”€ rag_app/                 // RAGåº”ç”¨ç¤ºä¾‹
â”‚       â”œâ”€â”€ Cargo.toml
â”‚       â””â”€â”€ src/main.rs
â”‚
â”œâ”€â”€ benches/                     // æ€§èƒ½åŸºå‡†æµ‹è¯•
â”‚   â”œâ”€â”€ agent_bench.rs           // Agentæ€§èƒ½æµ‹è¯•
â”‚   â””â”€â”€ workflow_bench.rs        // å·¥ä½œæµæ€§èƒ½æµ‹è¯•
â”‚
â”œâ”€â”€ tests/                       // é›†æˆæµ‹è¯•
â”‚   â”œâ”€â”€ agent_tests.rs           // Agenté›†æˆæµ‹è¯•
â”‚   â””â”€â”€ workflow_tests.rs        // å·¥ä½œæµé›†æˆæµ‹è¯•
â”‚
â”œâ”€â”€ docs/                        // æ–‡æ¡£
â”‚   â”œâ”€â”€ architecture.md          // æ¶æ„è¯´æ˜
â”‚   â”œâ”€â”€ usage/                   // ä½¿ç”¨æŒ‡å—
â”‚   â”‚   â”œâ”€â”€ agent.md
â”‚   â”‚   â””â”€â”€ workflow.md
â”‚   â”‚
â”‚   â””â”€â”€ api/                     // APIæ–‡æ¡£
â”‚       â”œâ”€â”€ agent.md
â”‚       â””â”€â”€ workflow.md
â”‚
â”œâ”€â”€ Cargo.toml                   // å·¥ä½œåŒºé…ç½®
â””â”€â”€ rust-toolchain.toml          // Rustå·¥å…·é“¾é…ç½®
```

### 4.2 æ ¸å¿ƒç±»å‹å®šä¹‰ âœ…

å·²åœ¨Rustä¸­å®šä¹‰ä¸TypeScriptç­‰æ•ˆçš„ç±»å‹ï¼Œå¹¶åˆ©ç”¨Rustçš„ç±»å‹ç³»ç»Ÿä¼˜åŠ¿ï¼š

```rust
// Agentç±»å‹ âœ…
pub struct Agent {
    id: String,
    config: AgentConfig,
    tools: Vec<Box<dyn Tool>>,
    memory: Option<Box<dyn Memory>>,
    llm: Box<dyn LlmProvider>,
}

// å·¥ä½œæµç±»å‹ âœ…
pub struct Workflow {
    id: String,
    definition: WorkflowDefinition,
    state: WorkflowState,
}

// å·¥å…·ç±»å‹ âœ…
pub trait Tool: Send + Sync {
    fn name(&self) -> &str;
    fn description(&self) -> &str;
    fn schema(&self) -> &ToolSchema;
    fn execute(&self, params: HashMap<String, Value>) -> Result<Value, ToolError>;
}
```

### 4.3 LLMé›†æˆ âœ…

```rust
pub trait LlmProvider: Send + Sync {
    fn generate(&self, prompt: &str, options: &LlmOptions) -> Result<String, LlmError>;
    fn generate_stream(&self, prompt: &str, options: &LlmOptions) -> BoxStream<'static, Result<String, LlmError>>;
    fn get_embedding(&self, text: &str) -> Result<Vec<f32>, LlmError>;
}

// å…·ä½“å®ç°
pub struct OpenAiProvider {
    api_key: String,
    model: String,
}

pub struct AnthropicProvider {
    api_key: String,
    model: String,
}
```

### 4.4 ä¾èµ–ç®¡ç†ä¼˜åŒ–

æ¯ä¸ªæ¨¡å—å°†æ˜ç¡®å£°æ˜å…¶ä¾èµ–å…³ç³»ï¼Œä½¿ç”¨ç‰¹æ€§æ ‡å¿—(features)æ”¯æŒå¯é€‰åŠŸèƒ½ï¼š

```toml
# lomusai_core/Cargo.toml ç¤ºä¾‹
[package]
name = "lomusai_core"
version = "0.1.0"
# ...

[features]
default = ["openai"]
openai = ["reqwest"]
anthropic = ["reqwest"]
full = ["openai", "anthropic"]

[dependencies]
# å¿…è¦ä¾èµ–
serde = { version = "1.0", features = ["derive"] }
thiserror = "1.0"
async-trait = "0.1"
futures = "0.3"
tokio = { version = "1.0", features = ["rt", "sync"], optional = true }

# å¯é€‰ä¾èµ–
reqwest = { version = "0.11", features = ["json"], optional = true }

# å†…éƒ¨ä¾èµ–
lomusai_types = { path = "../lomusai_types", version = "0.1.0" }
```

## 5. è¿ç§»è®¡åˆ’æ—¶é—´çº¿

| é˜¶æ®µ | ä¼°è®¡æ—¶é—´ | ä¸»è¦ä»»åŠ¡ | çŠ¶æ€ |
|------|---------|---------|------|
| åˆå§‹è®¾è®¡ä¸æ¶æ„ | 2å‘¨ | è®¾è®¡æ¶æ„ï¼Œå®šä¹‰æ ¸å¿ƒæ¥å£å’Œç±»å‹ | âœ… å®Œæˆ |
| æ ¸å¿ƒåº“å®ç° | 8å‘¨ | å®ç°Agent, Workflow, Toolæ ¸å¿ƒåŠŸèƒ½ | âœ… å®Œæˆ |
| RAGå®ç° | 4å‘¨ | å®ç°æ–‡æ¡£å¤„ç†ã€å‘é‡åŒ–å’Œæ£€ç´¢åŠŸèƒ½ | âœ… å®Œæˆ |
| Memoryå®ç° | 3å‘¨ | å®ç°è®°å¿†å­˜å‚¨å’Œæ£€ç´¢ç³»ç»Ÿ | âœ… å®Œæˆ |
| é›†æˆå¼€å‘ | 6å‘¨ | å¼€å‘ä¸»è¦ç¬¬ä¸‰æ–¹æœåŠ¡é›†æˆ | ğŸ”„ å¾…å¼€å§‹ |
| CLIä¸éƒ¨ç½² | 3å‘¨ | å®ç°å‘½ä»¤è¡Œå·¥å…·å’Œéƒ¨ç½²åŠŸèƒ½ | ğŸ”„ å¾…å¼€å§‹ |
| æµ‹è¯•ä¸ä¼˜åŒ– | 4å‘¨ | å…¨é¢æµ‹è¯•å’Œæ€§èƒ½ä¼˜åŒ– | ğŸ”„ éƒ¨åˆ†å®Œæˆ |
| æ–‡æ¡£ç¼–å†™ | 2å‘¨ | ç¼–å†™APIæ–‡æ¡£å’Œä½¿ç”¨æŒ‡å— | ğŸ”„ å¾…å¼€å§‹ |

## 6. æ€§èƒ½ä¼˜åŒ–ç›®æ ‡

åˆ©ç”¨Rustçš„æ€§èƒ½ä¼˜åŠ¿ï¼Œæˆ‘ä»¬è®¾å®šä»¥ä¸‹ä¼˜åŒ–ç›®æ ‡ï¼š

1. **å»¶è¿Ÿé™ä½**ï¼šå…³é”®æ“ä½œå»¶è¿Ÿæ¯”TypeScriptç‰ˆæœ¬é™ä½è‡³å°‘50%
2. **å†…å­˜ä½¿ç”¨å‡å°‘**ï¼šå†…å­˜å ç”¨å‡å°‘è‡³å°‘40%
3. **å¹¶å‘æ€§èƒ½æå‡**ï¼šåœ¨å¤šæ ¸ç¯å¢ƒä¸‹å®ç°çº¿æ€§æ‰©å±•
4. **å¯åŠ¨æ—¶é—´ä¼˜åŒ–**ï¼šå†·å¯åŠ¨æ—¶é—´å‡å°‘è‡³å°‘60%

## 7. è¿ç§»æŒ‘æˆ˜ä¸è§£å†³æ–¹æ¡ˆ

### 7.1 æŒ‘æˆ˜

1. **å¼‚æ­¥æ¨¡å‹å·®å¼‚**ï¼šTypeScriptå’ŒRustçš„å¼‚æ­¥æ¨¡å‹æœ‰æ˜¾è‘—å·®å¼‚ - âœ… å·²é€šè¿‡ä½¿ç”¨async_traitå’Œfuturesè§£å†³
2. **ç±»å‹ç³»ç»Ÿæ˜ å°„**ï¼šå°†TypeScriptçš„ç»“æ„ç±»å‹æ˜ å°„åˆ°Rustçš„æ ‡ç§°ç±»å‹ - âœ… å·²è§£å†³
3. **ç”Ÿæ€ç³»ç»Ÿå·®å¼‚**ï¼šæ‰¾åˆ°TypeScriptåº“çš„Rustç­‰æ•ˆåº“ - âœ… éƒ¨åˆ†è§£å†³
4. **åŠ¨æ€vsé™æ€**ï¼šå¤„ç†æŸäº›åŠ¨æ€è¡Œä¸ºåˆ°é™æ€ç±»å‹çš„è½¬æ¢ - âœ… éƒ¨åˆ†è§£å†³ï¼Œä½¿ç”¨äº†traitå¯¹è±¡
5. **æ¨¡å—åŒ–è®¾è®¡**ï¼šç¡®ä¿å„æ¨¡å—ä¹‹é—´çš„æ¸…æ™°è¾¹ç•Œå’Œæœ€å°ä¾èµ– - âœ… é‡‡ç”¨æ›´å¥½çš„æ¨¡å—åŒ–ç»“æ„è§£å†³

### 7.2 è§£å†³æ–¹æ¡ˆ

1. **å¼‚æ­¥å¤„ç†**ï¼šåˆ©ç”¨Rustçš„async/awaitå’Œtokioç”Ÿæ€ç³»ç»Ÿ âœ…
2. **ç±»å‹æ˜ å°„**ï¼šè®¾è®¡é€‚åˆRustçš„ç±»å‹ç»“æ„ï¼Œä¸ä»…ä»…æ˜¯1:1è½¬æ¢ âœ…
3. **ç”Ÿæ€ç³»ç»Ÿ**ï¼šä½¿ç”¨serdeå¤„ç†JSONï¼Œreqwestå¤„ç†HTTPç­‰ âœ…
4. **åŠ¨æ€è¡Œä¸º**ï¼šä½¿ç”¨æšä¸¾ã€traitå¯¹è±¡å’Œæ³›å‹æä¾›çµæ´»æ€§ âœ…
5. **æ¨¡å—åŒ–**ï¼šé‡‡ç”¨æ›´æ¸…æ™°çš„æ¨¡å—è¾¹ç•Œï¼Œä½¿ç”¨ç‰¹æ€§æ ‡å¿—æ§åˆ¶ä¾èµ– âœ…

## 8. æµ‹è¯•ç­–ç•¥

1. **å•å…ƒæµ‹è¯•**ï¼šæ¯ä¸ªæ¨¡å—çš„æ ¸å¿ƒåŠŸèƒ½ âœ…
2. **é›†æˆæµ‹è¯•**ï¼šæ¨¡å—é—´äº¤äº’ ğŸ”„
3. **åŸºå‡†æµ‹è¯•**ï¼šæ€§èƒ½å¯¹æ¯”ä¸ä¼˜åŒ– ğŸ”„
4. **å…¼å®¹æ€§æµ‹è¯•**ï¼šç¡®ä¿APIå…¼å®¹æ€§ ğŸ”„
5. **æ¨¡æ‹Ÿæµ‹è¯•**ï¼šé’ˆå¯¹ç¬¬ä¸‰æ–¹æœåŠ¡çš„æ¨¡æ‹Ÿæµ‹è¯• âœ…
6. **ç¤ºä¾‹åº”ç”¨**ï¼šå®Œæ•´çš„ç¤ºä¾‹åº”ç”¨éªŒè¯æ¡†æ¶åŠŸèƒ½ ğŸ”„

## 9. åç»­å·¥ä½œ

1. **å¢å¼ºåŠŸèƒ½**ï¼šåˆ©ç”¨Rustç”Ÿæ€ç³»ç»Ÿå¢å¼ºç°æœ‰åŠŸèƒ½
2. **è·¨å¹³å°æ”¯æŒ**ï¼šç¼–è¯‘åˆ°å¤šç§ç›®æ ‡å¹³å°
3. **WebAssemblyæ”¯æŒ**ï¼šç¼–è¯‘åˆ°WASMä»¥æ”¯æŒæµè§ˆå™¨ç¯å¢ƒ
4. **FFIç»‘å®š**ï¼šä¸ºå…¶ä»–è¯­è¨€æä¾›ç»‘å®š
5. **æ€§èƒ½ä¼˜åŒ–**ï¼šæŒç»­ä¼˜åŒ–å…³é”®è·¯å¾„çš„æ€§èƒ½
6. **ç”Ÿæ€ç³»ç»Ÿ**ï¼šæ„å»ºå‘¨è¾¹å·¥å…·å’Œåº“ç”Ÿæ€ç³»ç»Ÿ

## 10. ç»“è®º

é€šè¿‡å°†Mastraä»TypeScriptè¿ç§»åˆ°Rustï¼Œæˆ‘ä»¬å¯ä»¥è·å¾—æ˜¾è‘—çš„æ€§èƒ½æå‡ã€å¯é æ€§æé«˜å’Œæ›´è‰¯å¥½çš„ç±»å‹å®‰å…¨ã€‚åŒæ—¶ï¼ŒRustçš„å¤šç§ç¼–è¯‘ç›®æ ‡ä¹Ÿä½¿å¾—æ›´å¹¿æ³›çš„éƒ¨ç½²åœºæ™¯æˆä¸ºå¯èƒ½ã€‚ä¼˜åŒ–çš„æ¨¡å—åŒ–è®¾è®¡å°†ä½¿ä»£ç æ›´æ˜“äºç»´æŠ¤ã€æ‰©å±•å’Œç†è§£ã€‚

## 11. å·²å®ŒæˆåŠŸèƒ½

å·²å®ç°çš„æ ¸å¿ƒç»„ä»¶:

1. **æ ¸å¿ƒé”™è¯¯å¤„ç†ç³»ç»Ÿ** âœ… - ä½¿ç”¨thiserroræä¾›ç±»å‹å®‰å…¨çš„é”™è¯¯å¤„ç†
2. **LLMæä¾›è€…æ¥å£** âœ… - æ”¯æŒOpenAIå’ŒAnthropicæ¨¡å‹çš„æŠ½è±¡æ¥å£
   - å·²ä¿®å¤HTTPå“åº”æ‰€æœ‰æƒé—®é¢˜ âœ… - ç¡®ä¿æ­£ç¡®å¤„ç†HTTPå“åº”çš„æ¶ˆè´¹
   - æ”¹è¿›é”™è¯¯å¤„ç†é€»è¾‘ âœ… - ä½¿ç”¨æ›´æ¸…æ™°çš„if-elseç»“æ„åŒºåˆ†æˆåŠŸå’Œå¤±è´¥å“åº”
   - æ¶ˆé™¤äº†æœªä½¿ç”¨çš„å¯¼å…¥å’Œå˜é‡ âœ… - æé«˜äº†ä»£ç æ•´æ´åº¦
3. **å·¥å…·ç³»ç»Ÿ** âœ… - å¯æ‰©å±•çš„å·¥å…·æ¥å£ï¼ŒåŒ…æ‹¬å‚æ•°æ ¡éªŒå’Œæ‰§è¡Œ
4. **å†…å­˜ç³»ç»Ÿ** âœ… - ç”¨äºå­˜å‚¨å’Œæ£€ç´¢ä¸Šä¸‹æ–‡ä¿¡æ¯
5. **Agentå®ç°** âœ… - æ”¯æŒå·¥å…·è°ƒç”¨å’Œä¸Šä¸‹æ–‡ç®¡ç†çš„Agent
   - ä¿®å¤äº†ä¸´æ—¶å˜é‡å’Œæœªä½¿ç”¨å¯¼å…¥é—®é¢˜ âœ… - æé«˜äº†ä»£ç è´¨é‡
   - ä¼˜åŒ–äº†æµ‹è¯•å®ç° âœ… - ä¸å†ä¾èµ–å¤–éƒ¨HTTPæ¨¡æ‹Ÿåº“ï¼Œç®€åŒ–äº†æµ‹è¯•è¿‡ç¨‹
6. **å·¥ä½œæµå¼•æ“** âœ… - åŸºäºå›¾çš„çŠ¶æ€æœºå®ç°
   - å®Œå–„çš„å·¥ä½œæµæ­¥éª¤å®ç° âœ… - æ”¯æŒå„ç§æ­¥éª¤ç±»å‹å’Œæ¡ä»¶é€»è¾‘
   - åŸºäºä¾èµ–å›¾çš„å·¥ä½œæµæ‰§è¡Œ âœ… - ç¡®ä¿æ­£ç¡®çš„æ­¥éª¤æ‰§è¡Œé¡ºåº
   - æ”¯æŒæ¡ä»¶æ­¥éª¤å’Œåˆ†æ”¯é€»è¾‘ âœ… - å®ç°å¼ºå¤§çš„å·¥ä½œæµæ§åˆ¶æµ
   - å¼ºç±»å‹æ­¥éª¤è¾“å…¥å’Œè¾“å‡º âœ… - åˆ©ç”¨Rustç±»å‹ç³»ç»Ÿç¡®ä¿æ•°æ®å®‰å…¨
   - å¼‚æ­¥å·¥ä½œæµæ‰§è¡Œæ”¯æŒ âœ… - å…¨é¢åˆ©ç”¨Rustå¼‚æ­¥ç‰¹æ€§æé«˜æ€§èƒ½
   - å¯é‡è¯•å’Œé”™è¯¯å¤„ç†æœºåˆ¶ âœ… - æé«˜å·¥ä½œæµçš„ç¨³å®šæ€§å’Œå¯é æ€§
7. **é¥æµ‹ç³»ç»Ÿ** âœ… - ç”¨äºè®°å½•æ€§èƒ½å’Œè°ƒè¯•ä¿¡æ¯
8. **RAGç³»ç»Ÿ** âœ… - æ–‡æ¡£å¤„ç†ã€å‘é‡åµŒå…¥å’Œç›¸ä¼¼åº¦æœç´¢
   - æ–‡æ¡£åŠ è½½å’Œè§£æ âœ… - æ”¯æŒä¸åŒæ ¼å¼æ–‡æ¡£çš„åŠ è½½å’Œå¤„ç†
   - æ–‡æ¡£åˆ†å— âœ… - æ™ºèƒ½åˆ†å—ç­–ç•¥å°†æ–‡æ¡£åˆ‡åˆ†ä¸ºåˆé€‚çš„ç‰‡æ®µ
   - å‘é‡åµŒå…¥ âœ… - ç”Ÿæˆæ–‡æœ¬çš„å‘é‡è¡¨ç¤º
   - å‘é‡å­˜å‚¨å’Œæ£€ç´¢ âœ… - åŸºäºç›¸ä¼¼åº¦çš„æ–‡æ¡£æ£€ç´¢
9. **è¯„ä¼°æ¡†æ¶** âœ… - ç”¨äºè¯„ä¼°LLMè¾“å‡ºçš„ç³»ç»Ÿ
   - åŸºäºLLMçš„è¯„ä¼° âœ… - ä½¿ç”¨è¯­è¨€æ¨¡å‹è¯„ä¼°ç”Ÿæˆå†…å®¹çš„è´¨é‡ 
   - åŸºäºè§„åˆ™çš„è¯„ä¼° âœ… - æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼ã€å…³é”®è¯ã€é•¿åº¦é™åˆ¶å’Œè‡ªå®šä¹‰è¯„ä¼°è§„åˆ™
   - é€šç”¨è¯„ä¼°æ¥å£ âœ… - æŠ½è±¡åŒ–çš„Evaluatorå’ŒMetricæ¥å£ï¼Œæ”¯æŒæ‰©å±•
   - è¯„ä¼°æŒ‡æ ‡ âœ… - åŒ…å«å‡†ç¡®æ€§ã€ç›¸å…³æ€§ã€è¿è´¯æ€§ç­‰æŒ‡æ ‡
   - å¼‚æ­¥è¯„ä¼°æ”¯æŒ âœ… - å…¨é¢ä½¿ç”¨async/awaitä¼˜åŒ–è¯„ä¼°æµç¨‹
10. **é¡¹ç›®ç»“æ„ä¼˜åŒ–** âœ…
   - æ›´æ–°äº†å·¥ä½œåŒºé…ç½® âœ… - ä½¿ç”¨Rust 2021ç‰ˆæœ¬æ¨èçš„resolver = "2"è®¾ç½®
   - ä¼˜åŒ–äº†æ¨¡å—ç»“æ„ âœ… - æé«˜äº†ä»£ç å¯ç»´æŠ¤æ€§å’Œå¯æ‰©å±•æ€§
   - å®ç°äº†æ›´åŠ æ¸…æ™°çš„æ¨¡å—è¾¹ç•Œ âœ… - å‡å°‘äº†ä¸å¿…è¦çš„ä¾èµ–

æ‰€æœ‰å·²å®ç°çš„ç»„ä»¶å‡åŒ…å«å•å…ƒæµ‹è¯•ï¼Œå¹¶å·²é€šè¿‡æµ‹è¯•ã€‚ä¸‹ä¸€æ­¥å°†å¼€å§‹å®ç°CLIå’Œéƒ¨ç½²å·¥å…·æ¨¡å—ã€‚

## Lomusai

Lomusai is a platform for building and running AI applications. It provides a set of tools and services for developers to build, test, and deploy AI applications.

## Implementation Plan

The following provides a list of features and modules that we need to implement for the Lomusai platform.

### Core Modules

- [x] Error handling 
- [x] General utilities
- [x] Logging and telemetry
- [x] Workflow execution engine
  - [x] Workflow definition and execution
  - [x] Step dependencies and conditional execution
  - [x] Success and failure states
  - [x] Parallel execution of independent steps
  - [x] Skipping steps that do not meet conditions
- [ ] Memory storage (K/V and Vector)
- [ ] LLM providers
  - [ ] OpenAI
  - [ ] Anthropic
  - [ ] Local models
  - [ ] Multi-provider support
- [ ] Tools integration
  - [ ] Function calling
  - [ ] Tool definitions
  - [ ] Tool execution
- [ ] Agent implementation
  - [ ] Simple agent
  - [ ] Agent with tools
  - [ ] Agent with memory
  - [ ] Agent with workflow
- [ ] RAG (Retrieval Augmented Generation)
  - [ ] Document processing
  - [ ] Embedding generation
  - [ ] Retrieval
  - [ ] Generation
- [ ] Deployment
  - [ ] Local deployment
  - [ ] Cloud deployment
  - [ ] Environment configuration

### CLI

- [ ] Project initialization
- [ ] Local development
- [ ] Deployment
- [ ] Project management
- [ ] Extensions and plugins

### Integration APIs

- [ ] REST API
- [ ] WebSocket API
- [ ] SDK for different languages
  - [ ] TypeScript
  - [ ] Python
  - [ ] Rust 